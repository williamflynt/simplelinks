import logging
from typing import List, Tuple

from gui import start
from models import Graph, VertexType

logger = logging.getLogger(__name__)


def central_vtx_entities() -> List[str]:
    """The names of VertexEntity in our sample central_vtx_type vtx_type."""
    s = """geobounds,geo_ewkb,fips_code,fips_muni_code,fips_state_code,parcel_apn,master_parcel_apn,county,taxapn,taxapn_unf,unique_taxapn,alternate_taxapn,dupe_taxapn_seq,multi_taxapn_flag,site_addr,site_house_number,site_direction,site_street_name,site_mode,site_carrier_code,site_quadrant,site_unit_prefix,site_unit_number,site_city,site_state,site_zip,site_plus_4,_x_coord,_y_coord,geometry_source,addr_score,township,range,section,census_tract,census_block_group,block_number,owner_name,owner_name_1,owner_name_2,owner_1_first,owner_1_last,owner_1_mid,owner_2_first,owner_2_last,owner_2_mid,mail_addr,mail_house_number,mail_house_number_suffix,mail_direction,mail_street_name,mail_mode,mail_quadrant,mail_crrt,mail_city,mail_state,mail_zip,mail_plus_4,mail_unit_prefix,mail_unit_number,mail_care_of_name,owner_occupied,owner_src_code,use_code_muni_desc,use_code_muni,use_code_std_lps,use_code_std_desc_lps,use_code_std_ctgr_desc_lps,use_code_std_ctgr_lps,assessee_owner_name_1,assessee_owner_name_2,assessee_owner_vesting_code,assessee_owner_vesting_code_desc,tax_acct_nbr,asmt_mail_care_of_name,asmt_mail_house_number,asmt_mail_direction,asmt_mail_street_name,asmt_mail_mode,asmt_mail_quadrant,assessee_mail_addr,assessee_mail_city,assessee_mail_state,assessee_mail_zip,assessee_mail_zip4,assessee_mail_unit_prefix,assessee_mail_unit_number,asmt_mail_carrier_code,asmt_owner_occupied,val_assd_land,val_assd_imprv,val_assd,asmt_year,ca_home_owners_exempt,tax_exempt_codes,tax_exempt_codes_desc,tax_rate_code_area,tax_src_code,tax_amount,tax_year,tax_year_delinq,asmt_lndr_name,asmt_rcdrs_book,asmt_rcdrs_doc_number,asmt_rcdrs_page,asmt_rcdrs_date_transfer,asmt_doc_type,aggr_acreage,asmt_version_id,aggr_group,aggr_lot_count,aggr_lot_width_median,asmt_val_transfer,asmt_sale_code,asmt_sale_code_desc,asmt_prior_sale_date_transfer,asmt_prior_sale_val_transfer,asmt_prior_sale_sale_code,legal_full,legal_1,lot_code,lot_number,land_lot,city_section,district,legal_unit,zoning,municipality,subdivision,phase_nbr,tract_number,legal_sec_twp_rng,assr_map_ref,lot_size_area,lot_size_area_unit,lot_size_area_orgn,yr_blt,bldg_number,building_sqft,stories_number,stories_number_desc,total_rooms,units_number,bedrooms,total_baths,total_baths_calculated,partial_baths,garage_carport_type,garage_code_desc,parking_spaces,pool_indicator,pool_indicator_desc,val_mrkt_land,val_mrkt_imprv,val_market,yr_mrkt_val,buyer_name,bldg_class,bldg_class_desc,style_type,style_desc,construction_code,construction_code_desc,exterior_wall_type,exterior_wall_desc,foundation_type,foundation_type_desc,roof_cover_type,roof_cover_desc,heating_type,heating_desc,air_conditioning,air_conditioning_type_desc,elect_avail_code,elect_avail_code_desc,fireplace_type,bsmt_1_code,basement_finish_desc,acreage,cal_acreage,price_per_sqft,price_per_acre,land_per_sqft,land_sqft,cal_sqft,imprv_pct,imprv_per_sqft,last_sale_date_transfer,last_sale_doc_number,last_sale_doc_type,last_sale_doc_type_desc,last_sale_sale_code,last_sale_sale_code_desc,last_sale_seller_name,last_sale_seller_1_first_mid,last_sale_seller_1_last,last_sale_seller_1_code,last_sale_seller_1_code_desc,last_sale_seller_2_first_mid,last_sale_seller_2_last,last_sale_buyer_name,last_sale_buyer_1_code,last_sale_buyer_1_code_desc,last_sale_buyer_1_first_mid,last_sale_buyer_1_last,ownership_status_code,ownership_status_desc,last_sale_buyer_2_first_mid,last_sale_buyer_2_last,last_sale_buyer_2_code,last_sale_buyer_2_code_desc,last_sale_owner_occupied,last_sale_page,last_sale_vesting_code,last_sale_vesting_code_desc,prior_market_sale_date_transfer,prior_market_sale_val_transfer,date_assr_tape_cut,last_sale_val_transfer,last_mrkt_sale_src_code,last_sale_book,date_transfer,doc_type_lps,doc_type_desc_lps,val_transfer,sale_code,sale_code_desc,mult_port_code,seller_name,last_market_sale_seller_name,last_market_sale_seller_1_first_mid,last_market_sale_seller_1_last,last_market_sale_seller_1_code,last_market_sale_seller_1_code_desc,last_market_sale_seller_2_first_mid,last_market_sale_seller_2_last,last_market_sale_buyer_name,last_market_sale_buyer_1_first_mid,last_market_sale_buyer_1_last,last_market_sale_book,last_market_sale_buyer_1_code,last_market_sale_buyer_1_code_desc,last_market_sale_buyer_2_first_mid,last_market_sale_buyer_2_last,last_market_sale_buyer_2_code,last_market_sale_buyer_2_code_desc,last_market_sale_rcdrs_map_ref,last_market_sale_page,last_market_sale_loan_due_date,doc_number,doc_number_noval,td_doc_number_1,lender_code_1,lender_code_1_desc,title_company_name,lndr_first_name_1,company_flag,associate_property_count,loan_value_1,loan_value_2,loan_type_1,loan_type_1_desc,int_rate_type_1,int_rate_1_desc,int_rate_1,loan_due_date_1,last_market_sale_buyer_vesting_code,last_market_sale_buyer_vesting_code_desc,tran_type,tran_type_desc,prior_market_sale_source,prior_market_sale_book,prior_market_sale_doc_number,prior_market_sale_doc_type,prior_market_sale_doc_type_desc,prior_sale_date_transfer,prior_sale_doc_type,prior_sale_doc_type_desc,prior_sale_doc_number,last_market_sale_source,prior_sale_book,prior_market_sale_lndr_name,prior_sale_page,prior_market_sale_loan_due_date,prior_sale_val_transfer,prior_sale_sale_code,prior_sale_sale_code_desc,prior_market_sale_seller_1_first_mid,prior_market_sale_seller_1_last,prior_market_sale_seller_1_code,prior_market_sale_seller_1_code_desc,prior_market_sale_seller_2_first_mid,prior_market_sale_seller_2_last,prior_market_sale_buyer_1_first_mid,prior_market_sale_buyer_1_last,prior_market_sale_buyer_1_code,prior_market_sale_buyer_1_code_desc,prior_market_sale_buyer_2_first_mid,prior_market_sale_buyer_2_last,prior_market_sale_buyer_2_code,prior_market_sale_buyer_2_code_desc,prior_market_sale_page,prior_market_sale_rcdrs_map_ref,no_val_date_transfer,date_noval_transfer,doc_type_noval,book_noval_transfer,doc_type_noval_desc,page_noval_transfer,assessee_owner_1_indicator,assessee_owner_2_indicator,asmt_mail_care_of_name_indicator,assessee_owner_1_name_type,assessee_owner_2_name_type,asmt_mail_care_of_name_type,date_cert,assr_sqft,yr_blt_effect,assr_acreage,topography,topography_desc,lot_width,lot_depth,cbsa_code,avm_value,property_id,location_id,address_id,property_dmp_id,parcel_dmp_id,dpc,z4type,dpv,muniname,valcalc,valcalcind,landvalcalcind,impvalcalcind,appraisedval,appraisedlandval,appraisedimpval,prop_view,energy,fuel,sewer,water,qlty,cond,bldgcd,bldgimpcd,flr,frame,livingsqft,grdflrsqft,grosssqft,adjgrosssqft,bsmtsqft,prkgsqft,fullbaths,prop_1qtrbaths,prop_3qtrbaths,bathfixs,frplnbr,frpltype,poolcd,pid,pid2,addrid,addrid2,hhid,hhid2"""
    return s.split(",")


def component_entities() -> Tuple[List[str], List[str]]:
    """The names of VertexEntity for our two component VertexTypes."""
    leftschema = """geobounds,geo_ewkb,fips_code,fips_muni_code,fips_state_code,parcel_apn,master_parcel_apn,county,taxapn,taxapn_unf,unique_taxapn,alternate_taxapn,dupe_taxapn_seq,multi_taxapn_flag,site_addr,site_house_number,site_direction,site_street_name,site_mode,site_carrier_code,site_quadrant,site_unit_prefix,site_unit_number,site_city,site_state,site_zip,site_plus_4,_x_coord,_y_coord,geometry_source,addr_score,township,range,section,census_tract,census_block_group,block_number,owner_name,owner_name_1,owner_name_2,owner_1_first,owner_1_last,owner_1_mid,owner_2_first,owner_2_last,owner_2_mid,mail_addr,mail_house_number,mail_house_number_suffix,mail_direction,mail_street_name,mail_mode,mail_quadrant,mail_crrt,mail_city,mail_state,mail_zip,mail_plus_4,mail_unit_prefix,mail_unit_number,mail_care_of_name,owner_occupied,owner_src_code,use_code_muni_desc,use_code_muni,use_code_std_lps,use_code_std_desc_lps,use_code_std_ctgr_desc_lps,use_code_std_ctgr_lps,assessee_owner_name_1,assessee_owner_name_2,assessee_owner_vesting_code,assessee_owner_vesting_code_desc,tax_acct_nbr,asmt_mail_care_of_name,asmt_mail_house_number,asmt_mail_direction,asmt_mail_street_name,asmt_mail_mode,asmt_mail_quadrant,assessee_mail_addr,assessee_mail_city,assessee_mail_state,assessee_mail_zip,assessee_mail_zip4,assessee_mail_unit_prefix,assessee_mail_unit_number,asmt_mail_carrier_code,asmt_owner_occupied,val_assd_land,val_assd_imprv,val_assd,asmt_year,ca_home_owners_exempt,tax_exempt_codes,tax_exempt_codes_desc,tax_rate_code_area,tax_src_code,tax_amount,tax_year,tax_year_delinq,asmt_lndr_name,asmt_rcdrs_book,asmt_rcdrs_doc_number,asmt_rcdrs_page,asmt_rcdrs_date_transfer,asmt_doc_type,aggr_acreage,asmt_version_id,aggr_group,aggr_lot_count,aggr_lot_width_median,asmt_val_transfer,asmt_sale_code,asmt_sale_code_desc,asmt_prior_sale_date_transfer,asmt_prior_sale_val_transfer,asmt_prior_sale_sale_code,legal_full,legal_1,lot_code,lot_number,land_lot,city_section,district,legal_unit,zoning,municipality,subdivision,phase_nbr,tract_number,legal_sec_twp_rng,assr_map_ref,lot_size_area,lot_size_area_unit,lot_size_area_orgn,yr_blt,bldg_number,building_sqft,stories_number,stories_number_desc,total_rooms,units_number,bedrooms,total_baths,total_baths_calculated,partial_baths,garage_carport_type,garage_code_desc,parking_spaces,pool_indicator,pool_indicator_desc,val_mrkt_land,val_mrkt_imprv,val_market,yr_mrkt_val,buyer_name,bldg_class,bldg_class_desc,style_type,style_desc,construction_code,construction_code_desc,exterior_wall_type,exterior_wall_desc,foundation_type,foundation_type_desc,roof_cover_type,roof_cover_desc,heating_type,heating_desc,air_conditioning,air_conditioning_type_desc,elect_avail_code,elect_avail_code_desc,fireplace_type,bsmt_1_code,basement_finish_desc,acreage,cal_acreage,price_per_sqft,price_per_acre,land_per_sqft,land_sqft,cal_sqft,imprv_pct,imprv_per_sqft,last_sale_date_transfer,last_sale_doc_number,last_sale_doc_type,last_sale_doc_type_desc,last_sale_sale_code,last_sale_sale_code_desc,last_sale_seller_name,last_sale_seller_1_first_mid,last_sale_seller_1_last,last_sale_seller_1_code,last_sale_seller_1_code_desc,last_sale_seller_2_first_mid,last_sale_seller_2_last,last_sale_buyer_name,last_sale_buyer_1_code,last_sale_buyer_1_code_desc,last_sale_buyer_1_first_mid,last_sale_buyer_1_last,ownership_status_code,ownership_status_desc,last_sale_buyer_2_first_mid,last_sale_buyer_2_last,last_sale_buyer_2_code,last_sale_buyer_2_code_desc,last_sale_owner_occupied,last_sale_page,last_sale_vesting_code,last_sale_vesting_code_desc,prior_market_sale_date_transfer,prior_market_sale_val_transfer,date_assr_tape_cut,last_sale_val_transfer,last_mrkt_sale_src_code,last_sale_book,date_transfer,doc_type_lps,doc_type_desc_lps,val_transfer,sale_code,sale_code_desc,mult_port_code,seller_name,last_market_sale_seller_name,last_market_sale_seller_1_first_mid,last_market_sale_seller_1_last,last_market_sale_seller_1_code,last_market_sale_seller_1_code_desc,last_market_sale_seller_2_first_mid,last_market_sale_seller_2_last,last_market_sale_buyer_name,last_market_sale_buyer_1_first_mid,last_market_sale_buyer_1_last,last_market_sale_book,last_market_sale_buyer_1_code,last_market_sale_buyer_1_code_desc,last_market_sale_buyer_2_first_mid,last_market_sale_buyer_2_last,last_market_sale_buyer_2_code,last_market_sale_buyer_2_code_desc,last_market_sale_rcdrs_map_ref,last_market_sale_page,last_market_sale_loan_due_date,doc_number,doc_number_noval,td_doc_number_1,lender_code_1,lender_code_1_desc,title_company_name,lndr_first_name_1,company_flag,associate_property_count,loan_value_1,loan_value_2,loan_type_1,loan_type_1_desc,int_rate_type_1,int_rate_1_desc,int_rate_1,loan_due_date_1,last_market_sale_buyer_vesting_code,last_market_sale_buyer_vesting_code_desc,tran_type,tran_type_desc,prior_market_sale_source,prior_market_sale_book,prior_market_sale_doc_number,prior_market_sale_doc_type,prior_market_sale_doc_type_desc,prior_sale_date_transfer,prior_sale_doc_type,prior_sale_doc_type_desc,prior_sale_doc_number,last_market_sale_source,prior_sale_book,prior_market_sale_lndr_name,prior_sale_page,prior_market_sale_loan_due_date,prior_sale_val_transfer,prior_sale_sale_code,prior_sale_sale_code_desc,prior_market_sale_seller_1_first_mid,prior_market_sale_seller_1_last,prior_market_sale_seller_1_code,prior_market_sale_seller_1_code_desc,prior_market_sale_seller_2_first_mid,prior_market_sale_seller_2_last,prior_market_sale_buyer_1_first_mid,prior_market_sale_buyer_1_last,prior_market_sale_buyer_1_code,prior_market_sale_buyer_1_code_desc,prior_market_sale_buyer_2_first_mid,prior_market_sale_buyer_2_last,prior_market_sale_buyer_2_code,prior_market_sale_buyer_2_code_desc,prior_market_sale_page,prior_market_sale_rcdrs_map_ref,no_val_date_transfer,date_noval_transfer,doc_type_noval,book_noval_transfer,doc_type_noval_desc,page_noval_transfer,assessee_owner_1_indicator,assessee_owner_2_indicator,asmt_mail_care_of_name_indicator,assessee_owner_1_name_type,assessee_owner_2_name_type,asmt_mail_care_of_name_type,date_cert,assr_sqft,yr_blt_effect,assr_acreage,topography,topography_desc,lot_width,lot_depth,cbsa_code,avm_value,property_id,location_id,address_id,property_dmp_id,parcel_dmp_id"""
    rightschema = """id,pid,pid2,fname,mname,lname,suffix,fname2,mname2,lname2,suffix2,busname,rectype,phone,phone2,house,predir,street,strtype,postdir,apttype,aptnbr,city,state,zip,z4,dpc,crte,cntycd,z4type,dpv,vacant,house2,predir2,street2,strtype2,postdir2,apttype2,aptnbr2,city2,state2,zip2,z42,dpc2,crte2,cntycd2,z4type2,dpv2,vacant2,prop_fipscd,prop_censustract,prop_muniname,prop_townshipcd,prop_subdivision,prop_zoning,prop_range,prop_section,prop_latitude,prop_longitude,prop_landuse,prop_apn,prop_apnseqnbr,prop_ownerocc,prop_addrind,prop_corpind,prop_rescd,prop_ind,prop_mobhome,prop_nrbbld,prop_style,prop_storiescd,prop_storiesnbr,prop_aptnbr,prop_qlty,prop_bldgcd,prop_bldgimpcd,prop_cond,prop_cnstrtype,prop_extnw,prop_valcalc,prop_val_calcind,prop_land_valcalc,prop_land_valcalc_ind,prop_imp_valcalc,prop_imp_valcalc_ind,prop_assed_val,prop_assed_landval,prop_assed_impval,prop_mrktval,prop_mrkt_landval,prop_mrkt_impval,prop_appraised_val,prop_appraised_landval,prop_appraised_impval,prop_yrbld,prop_effyrbld,prop_view,prop_lctn_infl,prop_frontft,prop_depthft,prop_acres,prop_landsqft,prop_unvbldsqft,prop_bldsqftind,prop_bldsqft,prop_livingsqft,prop_grdflrsqft,prop_grosssqft,prop_adjgrosssqft,prop_bsmtsqft,prop_prkgsqft,prop_rms,prop_bedrms,prop_bathscalc,prop_baths,prop_fullbaths,prop_halfbaths,prop_1qtrbaths,prop_3qtrbaths,prop_bathfixs,prop_ac,prop_bsmtf,prop_frpl,prop_frplnbr,prop_frpltype,prop_fnd,prop_flr,prop_frame,prop_gar,prop_heat,prop_prkgspaces,prop_prkgtype,prop_pool,prop_poolcd,prop_roofcover,prop_rooftype,prop_energy,prop_fuel,prop_sewer,prop_water,prop_homestead,prop_xmtvet,prop_xmt_disabled,prop_taxamt,prop_taxyr,prop_docyr,prop_salesdeedcd,prop_recdate,prop_sellername,prop_saledate,prop_saleamt,prop_salecd,prop_apncd,prop_apncnt,prop_asmtyr,prop_salestranscd,prop_recdate_prior,prop_saledate_prior,prop_saleamt_prior,prop_salecd_prior,prop_apncd_prior,prop_deedcd_prior,prop_docyr_prior,prop_deedtype_prior,prop_salestranscd_prior,prop_mtgamt_prior,internal,prop_ownercd,prop_sellcarryback,prop_tittlecompany,prop_loantoval,prop_mtgamt,prop_mtgdate,prop_mtgloancd,prop_mtgdeedcd,prop_mtgterm,prop_mtgduedate,prop_mtgassumptionamt,prop_lendername,prop_mtgreficd,prop_rmsequitycd,prop_mtgintrate,prop_mtgintratetype,prop_mtgamt2,prop_mtgdate2,prop_mtgloancd2,prop_mtgdeedcd2,prop_mtgterm2,prop_mtgduedate2,prop_mtgassumptionamt2,prop_lendername2,prop_mtgreficd2,prop_rmsequitycd2,prop_mtgintrate2,prop_mtgintratetype2,prop_mtgamt3,prop_mtgdate3,prop_mtgloancd3,prop_mtgdeedcd3,prop_mtgterm3,prop_mtgduedate3,prop_mtgassumptionamt3,prop_lendername3,prop_mtgreficd3,prop_rmsequitycd3,prop_mtgintrate3,prop_mtgintratetype3,prop_input_address,prop_input_city,prop_input_state,prop_input_zip,addrid,addrid2,hhid,hhid2,odate,internal2,internal3,internal4"""
    return leftschema.split(","), rightschema.split(",")


def link_three_schemas(central: List[str], s1: List[str], s2: List[str]) -> Graph:
    """Link two lists of entity names; output the mapping as a Graph."""
    c = VertexType(entities=central, name="mergedschema")
    m = VertexType(entities=s1, name="leftschema")
    n = VertexType(entities=s2, name="rightschema")
    # The central_vtx_type VertexType here goes in the middle, strictly for GUI layout.
    g = Graph(m, c, n, entity_pairs=[])
    start(g, c)
    return g


if __name__ == "__main__":
    """Run demo with sample schemas."""
    # entity lists that we want to link to entities in a central_vtx_type object.
    left, right = component_entities()
    # Our demo central_vtx_type VertexType.
    central = central_vtx_entities()
    g = link_three_schemas(central, left, right)
    logger.info("done")
